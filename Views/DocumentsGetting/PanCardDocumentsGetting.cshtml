@{
    ViewBag.Title = "PanCardDocumentsGetting";
}

<h2>PanCard Documents Getting</h2>
<script type="text/javascript">
    $(document).ready(function () {
        $('.file').change(function () {
            debugger;
            var b = $('.file').val();
            var file = getNameFromPath($(this).val());
            var flag;
            if (file != null) {
                var extension = file.substr((file.lastIndexOf('.') + 1));
                switch (extension) {
                    case 'xls':
                        flag = true;
                        break;
                    case 'xlsx':
                        flag = true;
                        break;
                    default:
                        flag = false;
                }
            }
            else {
                alert('Please select xls file');
                return false;
            }

            if (flag == false) {
                alert("File should be in xls Or xlsx format only");
                $(this).val('');
                return false;
            }
            else {
                //var size = GetFileSize(file);
                //if (size > 51200) {
                //    alert("File should not exceed 50 KB in Size");
                //    $(this).val('');
                //}
                //else {
                //    $(".files > span").text("");
                //}

            }
        });

        function GetFileSize1(fileid) {
            try {
                var fileSize = 0;
                //for IE

                if ($.browser.msie) {
                    //before making an object of ActiveXObject, 
                    //please make sure ActiveX is enabled in your IE browser
                    var objFSO = new ActiveXObject("Scripting.FileSystemObject");
                    var filePath = $("#" + fileid)[0].value;
                    var objFile = objFSO.getFile(filePath);
                    var fileSize = objFile.size; //size in kb
                    //fileSize = fileSize / 1048576; //size in mb 
                }
                    //for FF, Safari, Opeara and Others
                else {
                    fileSize = $(".Pfile")[0].files[0].size //size in kb
                }
                return fileSize;
            }
            catch (e) {
            }
        }
        //get file path from client system
        function getNameFromPath(strFilepath) {
            var objRE = new RegExp(/([^\/\\]+)$/);
            var strName = objRE.exec(strFilepath);

            if (strName == null) {
                return null;
            }
            else {
                return strName[0];
            }
        }
    });
</script>
@using (Html.BeginForm("PanCardDocumentsGetting", "DocumentsGetting", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <div style="display:inline-flex;margin-left:450px;margin-top:50px;">
        <div>
            <input type="file" name="UploadFile" class="file" style="margin-top:10px;"/>
        </div>
        <div>
            <input type="submit" value="Get Documents"/>
        </div>
    </div>
}
