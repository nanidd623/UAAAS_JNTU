@using System.Web.Configuration
@model List<UAAAS.Controllers.AdmittedCourseDetails>
@{
    ViewBag.Title = "Merger Of Course(s)";
    int num = 1;
    int mergenum = 1;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>

    <link href="~/Scripts/Jquerydatatables/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="~/Scripts/Jquerydatatables/jquery.dataTables.min.js"></script>
    <script src="~/Scripts/Jquerydatatables/dataTables.bootstrap.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.8.20.min.js"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Validations.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            // Delete Confirmation
            $(".confirmDialog").live("click", function (e) {
                debugger;
                var url = $(this).attr('href');
                $("#dialog-confirm").dialog({
                    title: "Delete Merge Intake Request",
                    autoOpen: false,
                    resizable: false,
                    height: 170,
                    width: 350,
                    show: { effect: 'drop', direction: "up" },
                    modal: true,
                    draggable: true,
                    buttons: {
                        "Yes": function () {
                            $(this).dialog("close");
                            window.location = url;
                        },
                        "No": function () {
                            $(this).dialog("close");
                        }
                    }
                });

                $("#dialog-confirm").dialog('open');
                return false;
            });
        });
    </script>
</head>
<body>
    <h2>Merger Of Course(s)</h2>

    @if (TempData["Error"] != null)
    {
        <div class="error">
            <p><strong>Error:</strong> @TempData["Error"].ToString()</p>
        </div>
    }
    @if (TempData["Success"] != null)
    {
        <div class="success">
            <p><strong>Success:</strong> @TempData["Success"].ToString()</p>
        </div>
    }


    @using (Html.BeginForm("MergeCourseIntakechange", "CollegeNOC", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        @Html.ValidationSummary(true)
        <table class="full_table" style="width: 100%; font-size: 0.9rem;">
            <tr>
                <th style="text-align: left;">
                    S.No
                </th>
                <th style="text-align: left;">
                    Name of the Course
                </th>
                <th style="text-align: left;">
                    Approved Intake
                </th>
                <th style="text-align: left;">
                    Course to be merged
                </th>
                @*<th style="text-align: center;">
                        Intake
                    </th>*@
            </tr>

            @for (int i = 0; i < Model.Count; i++)
            {
                @Html.HiddenFor(model => model[i].SpecializationId)
                @Html.HiddenFor(model => model[i].SpecializationName)
                @Html.HiddenFor(model => model[i].DegreeId)
                @Html.HiddenFor(model => model[i].DegreeName)
                @Html.HiddenFor(model => model[i].CourseName)
                @Html.HiddenFor(model => model[i].ApprovedIntakeParent)
                <tr>
                    <td style="text-align: left;">@(num++)</td>
                    <td style="text-align: left;">@Html.DisplayFor(model => model[i].CourseName)</td>
                    <td style="text-align: left;">@Html.DisplayFor(model => model[i].ApprovedIntakeParent)</td>
                    <td style="text-align: left;">
                        @Html.DropDownListFor(model => model[i].SpecializationIdChild, // "SpecializationIdChild",
                                        new SelectList(ViewBag.AdmittedCoursesType as System.Collections.IEnumerable, "SpecializationId", "CourseName"),
                                     "--Select Merged Course--", new { id = "SpecializationId", style = "width: 75%", @class = "form-control" })
                    </td>
                    @*<td style="text-align: center;">
                            @Html.TextBoxFor(model => model[i].ApprovedIntakeChild, new { @placeholder = "Enter Intake of merged course", @maxlength = "3", @onkeypress = "return isNumeric(event)", style = "width: 25%" })
                        </td>*@
                </tr>
            }
        </table>
        <div style="float:right;">
            <input type="submit" value="Save" />
        </div>

        if (Model.Count == 0)
        {
            <div class="warning" style="width: 200px; margin: 0 auto;">
                <p>No records found</p>
            </div>
        }
    }

    @if (ViewBag.Count > 0)
    {
        <br /><br />
        <h2>List of Added Merger Of Course(s)</h2>
        <table class="full_table" style="width: 100%; font-size: 0.9rem;">
            <tr>
                <th style="text-align: left;">
                    S.No
                </th>
                <th style="text-align: left;">
                    Name of the Course
                </th>
                <th style="text-align: left;">
                    Approved Intake
                </th>
                <th style="text-align: left;">
                    Course to be merged
                </th>
                <th style="text-align: left;">
                    Merged Intake
                </th>
                <th style="text-align: left;">
                    Total Intake
                </th>
                <th style="text-align: left;">
                    Action
                </th>
            </tr>

            @foreach (var mergeitem in ViewBag.MergedCourseLst as List<UAAAS.Controllers.MergedCourseDetails>)
            {
                <tr>
                    <td style="text-align: left;">@(mergenum++)</td>
                    <td style="text-align: left;">@mergeitem.DegreeNameParent</td>
                    <td style="text-align: left;">@mergeitem.ApprovedIntakeParent</td>
                    <td style="text-align: left;">@mergeitem.DegreeNameChild</td>
                    <td style="text-align: left;">@mergeitem.ApprovedIntakeChild</td>
                    <td style="text-align: left;">@mergeitem.TotalIntake</td>
                    <td style="text-align: left;">
                        <p style="text-align:left;">
                            @if (mergeitem.Isclosure == false)
                            {
                                <a href="/CollegeNOC/MergeCourseDeleteIntake?Id=@mergeitem.MergedId" class="confirmDialog create_button" style="color:white;">
                                    <span>Delete</span>
                                </a>
                            }
                        </p>
                    </td>
                </tr>
            }
        </table>

        <table style="width: 100%">
            <tr>
                <td></td>
                <td class="create_link_right">
                    <br />@Html.ActionLink("Pay", "MergeIntakeFeeDetails", "CollegeNOC", new { collegeId = UAAAS.Models.Utilities.EncryptString(@ViewBag.collegeId, WebConfigurationManager.AppSettings["CryptoKey"]) }, new { @class = "create_button" })
                </td>
            </tr>
        </table>
    }
</body>
</html>
<div id="dialog-confirm" style="display: none">
    <p>
        <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
        Are you sure to delete ?
    </p>
</div>  