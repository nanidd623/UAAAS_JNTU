@model UAAAS.Models.CollegeDirectPrinicpalExperience
@{
    ViewBag.Title = " Principal / Director Experience Adding";
    //Layout = "~/Views/Shared/_LayoutLeftMenu.cshtml";
}
<!DOCTYPE html>

<html>
<head>
    <script src="~/Scripts/jquery-1.7.1.min.js"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
    @*<script src="@Url.Content("~/Scripts/Validations.js")" type="text/javascript"></script>*@
    <link href="@Url.Content("~/Content/jntuh-styles.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/themes/base/jquery.ui.datepicker.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.20.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            $("#designation").change(function () {
                if ($(this).val() == 4 || $(this).val() == 5) {
                    $("#supportingdoc3").removeClass('required').css("background-color", "#FCF1D1");
                    $("#supportingdoc3").css("color", "Black");
                }
                else {
                    $("#supportingdoc3").addClass('required');
                    $("#supportingdoc3").css("background-color", "#fc6a6c");
                    $("#supportingdoc3").css("color", "White");
                }
            });

            $(".ispresentlyworkingyes").click(function () {
                $('#supportingdoc2').attr('disabled', 'disabled');
                $("#todate").datepicker().datepicker('disable');
            });

            $(".ispresentlyworkingno").click(function () {
                $("#todate").datepicker().datepicker('enable');
                $("#supportingdoc2").removeAttr('disabled');
            });

            $(".confirmDialog").live("click", function (e) {

                var url = $(this).attr('href');
                $("#dialog-confirm").dialog({
                    title: 'Delete Experience Details',
                    autoOpen: false,
                    resizable: false,
                    height: 170,
                    width: 350,
                    show: { effect: 'drop', direction: "up" },
                    modal: true,
                    draggable: true,
                    buttons: {
                        "Yes": function () {
                            $(this).dialog("close");
                            window.location = url;

                        },
                        "No": function () {
                            $(this).dialog("close");

                        }
                    }
                });
                $("#dialog-confirm").dialog('open');
                return false;
            });

            $(".Supportingfile").change(function () {
                debugger;
                var rdid = $(this).attr('id');
                var file = getNameFromPath($(this).val());
                var docid = rdid.substr(13, 14);
                var flag;
                if (file != null) {
                    var extension = file.substr((file.lastIndexOf('.') + 1));
                    switch (extension) {
                        case 'pdf':
                        case 'PDF':
                            flag = true;
                            break;
                        default:
                            flag = false;
                    }
                }

                if (flag == false) {
                    //alert("You can upload only  PDF files");
                    $(".SupportingfileSpan" + docid).text("You can upload only  PDF files");
                    $(".SupportingfileSpan" + docid).css("color", "red");
                    $(this).val('');
                    return false;
                } else {
                    var size = GetFileSize(file, rdid);
                    size = size / 1048576;
                    if (size > 1) {
                        $(".SupportingfileSpan" + docid).text("Document should not exceed 1 MB in Size");
                        $(".SupportingfileSpan" + docid).css("color", "red");
                        $(this).val('');
                    } else {
                        $(".SupportingfileSpan" + docid).text("");
                    }
                }
            });


            //get file path from client system
            function getNameFromPath(strFilepath) {
                var objRE = new RegExp(/([^\/\\]+)$/);
                var strName = objRE.exec(strFilepath);

                if (strName == null) {
                    return null;
                } else {
                    return strName[0];
                }
            }

            //get file size
            function GetFileSize(fileid, title) {

                try {
                    var fileSize = 0;
                    //for IE
                    if ($.browser.msie) {
                        //before making an object of ActiveXObject,
                        //please make sure ActiveX is enabled in your IE browser
                        var objFSO = new ActiveXObject("Scripting.FileSystemObject");
                        var filePath = $("#" + fileid)[0].value;
                        var objFile = objFSO.getFile(filePath);
                        var fileSize = objFile.size; //size in kb
                        //fileSize = fileSize / 1048576; //size in mb
                    }
                        //for FF, Safari, Opeara and Others
                    else {
                        fileSize = $("#" + title)[0].files[0].size;//size in kb
                        //fileSize = fileSize / 1048576; //size in mb
                    }

                    return fileSize;
                } catch (e) {

                    //alert("Error is : " + e);
                }
            }
        });
    </script>
</head>
<body>
    <h2>Experience Details for Principal/Director</h2>
    <br /><p><b style="color:red;font-size:14px;">Note: </b><span style="font-weight:bold;color:red;font-size:14px;">Please upload all the details with relevant proofs.</span></p>
    @using (Ajax.BeginForm("FacultyExperienceAdd", "DirectRecruitmentPrincipalDirector", new AjaxOptions { }, new { enctype = "multipart/form-data" }))
    {
        @Html.ValidationSummary(true)
        if (TempData["Error"] != null)
        {
            <div class="error">
                <p><strong>Error:</strong> @TempData["Error"].ToString()</p>
            </div>
        }
        if (TempData["Success"] != null)
        {
            <div class="success">
                <p><strong>Success:</strong> @TempData["Success"].ToString()</p>
            </div>
        }

        @Html.HiddenFor(model => model.collegeid, new { @Value = Model.collegeid })
        @Html.HiddenFor(model => model.activityid, new { @Value = Model.activityid })
        <fieldset>
            <legend></legend>
            <div class="editor-label" style="width: 230px;">
                <span>Registration Number</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.TextBoxFor(model => model.registrationnumber, new { @required = "true", @placeholder = "Enter Registration Number", @style = "width:265px;" })
                @Html.ValidationMessageFor(model => model.registrationnumber)
            </div>
            <div class="editor-label" style="width: 230px;">
                <span>Presently Working as Principal</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.RadioButtonFor(model => model.presentlyWorking, true, new { @id = "ispresentlyworkingyes", @class = "ispresentlyworkingyes" }) Yes
                @Html.RadioButtonFor(model => model.presentlyWorking, false, new { @id = "ispresentlyWorkingno", @class = "ispresentlyworkingno" }) No
            </div>
            <div class="editor-label" style="width: 230px;">
                <span>Working Insitute/Organisation Name</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.TextBoxFor(model => model.workingorganisationName, new { @required = "true", @placeholder = "Enter Working Insitute/Organisation Name", @style = "width:265px;" })
                @Html.ValidationMessageFor(model => model.workingorganisationName)
            </div>
            <div class="editor-label" style="width: 230px;">
                <span>From Date</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.TextBoxFor(model => model.fromdate, new { @class = "calendar required", @placeholder = "DD/MM/YYYY" }) @*, @onblur = "IsValidDate(this,event.keyCode,0,0,1)", @onkeydown = "return IsValidFormat(this,event.keyCode)"*@
            </div>
            <div id="todatecond">
                <div class="editor-label" style="width: 230px;">
                    <span>To Date</span>
                </div>
                <div class="editor-field" style="width: 400px;">
                    @Html.TextBoxFor(model => model.todate, new { @class = "calendar required", @placeholder = "DD/MM/YYYY" })@*, @onblur = "IsValidDate(this,event.keyCode,0,0,1)", @onkeydown = "return IsValidFormat(this,event.keyCode)"*@
                </div>
            </div>
            <div class="editor-label" style="width: 230px;">
                <span>Designation</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.DropDownListFor(model => model.designationid,
                new SelectList(ViewBag.designation as System.Collections.IEnumerable, "Value", "Text"),
                "-- Select --", new { id = "designation" })
            </div>
            <div class="editor-label" style="width: 230px;">
                <span>Appointment & Joining Letter</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.TextBoxFor(model => model.supportingdoc1, new { type = "file", @id = "supportingdoc1", @name = "@file", @class = "required Supportingfile" }) @*, @disabled = "disabled"*@
                @Html.HiddenFor(model => model.supportingdoc1path)<br />
                <span class="SupportingfileSpan1" style="color:red;"></span>
            </div>

            <div class="editor-label" style="width: 230px;">
                <span>Relieving Letter</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.TextBoxFor(model => model.supportingdoc2, new { type = "file", @id = "supportingdoc2", @name = "@file", @class = "required Supportingfile" }) @*, @disabled = "disabled"*@
                @Html.HiddenFor(model => model.supportingdoc2path)<br />
                <span class="SupportingfileSpan2" style="color:red;"></span>
            </div>

            <div class="editor-label" style="width: 230px;">
                <span>Selection Minutes</span>
            </div>
            <div class="editor-field" style="width: 400px;">
                @Html.TextBoxFor(model => model.supportingdoc3, new { type = "file", @id = "supportingdoc3", @name = "@file", @class = "Supportingfile" }) @*, @disabled = "disabled"*@
                @Html.HiddenFor(model => model.supportingdoc3path)<br />
                <span class="SupportingfileSpan3" style="color:red;"></span>
            </div>

            @Html.HiddenFor(model => model.collegeid)

        </fieldset>
        <div style="text-align: center">
            <p>
                <input type="submit" value="Add" id="btnsend" name="cmd" style="height:22px;" />
                @Html.ActionLink("Cancel", "Index", "DirectRecruitmentPrincipalDirector", null, new { @class = "create_button" })
            </p>
        </div>

        if (ViewBag.CollegeDirectPrinicpalExperience.Count > 0)
        {
            <div style="margin-top:15px;">
                <h2>View Uploaded details</h2><br />
                <table class="webGrid" style="width: 100%;">
                    <thead>
                        <tr class="col1">
                            <th>S.No</th>
                            <th>Registration Number</th>
                            <th>Faculty Name</th>
                            <th>From Date</th>
                            <th>To Date</th>
                            <th>Duration</th>
                            <th>Designation</th>
                            <th>Appointment & Joining Letter</th>
                            <th>Relieving Letter</th>
                            <th>Selection minutes</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var pay in ((List<UAAAS.Models.CollegeDirectPrinicpalExperience>)ViewBag.CollegeDirectPrinicpalExperience).Select((value, i) => new { i = i + 1, value }))
                        {
                            <tr class="col2">
                                <td>@pay.i </td>
                                <td>@pay.value.registrationnumber</td>
                                <td>@pay.value.facultyName</td>
                                <td>@pay.value.fromdate</td>
                                <td>
                                    @if (@pay.value.todate == "01-01-1900")
                                    {
                                        <span>NA</span>
                                    }
                                    else
                                    {
                                        @pay.value.todate
                                    }
                                </td>
                                <td>@pay.value.displayExperience</td>
                                <td>@pay.value.designation</td>
                                <td>
                                    @if (@pay.value.supportingdoc1path != null)
                                    {
                                        <a href="~/Content/Upload/College/DirectPrinicpalRecruit/PrincipalExperience/@pay.value.supportingdoc1path" target="_blank">
                                            <span style="color: red;"><b>View</b></span>
                                        </a>
                                    }
                                <td>
                                    @if (@pay.value.supportingdoc2path != null)
                                    {
                                        <a href="~/Content/Upload/College/DirectPrinicpalRecruit/PrincipalExperience/@pay.value.supportingdoc2path" target="_blank">
                                            <span style="color: red;"><b>View</b></span>
                                        </a>
                                    }
                                </td>
                                <td>
                                    @if (@pay.value.supportingdoc3path != null)
                                    {
                                        <a href="~/Content/Upload/College/DirectPrinicpalRecruit/PrincipalExperience/@pay.value.supportingdoc3path" target="_blank">
                                            <span style="color: red;"><b>View</b></span>
                                        </a>
                                    }
                                    else
                                    {
                                        <span><b>N/A</b></span>
                                    }
                                </td>
                                <td>
                                    @*<a href="/Faculty/Delete?fid=" class="delete_button"><span>Delete</span></a>*@
                                    @Html.ActionLink("Delete", "DeleteExperience", new { encactivityId = @pay.value.encactivityId, enccollegeid = @pay.value.enccollegeId }, new { @class = "confirmDialog delete_button" })
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    }
</body>
</html>
<div id="dialog-confirm" style="display: none">
    <p>
        <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
        Are you sure to delete ?
    </p>
</div>