@model IList<UAAAS.Models.PhysicalLabMaster>

@{
    ViewBag.Title = "SUBMISSION OF ONLINE APPEAL";
    int index = 1;
}
@using UAAAS.Models;
<h2>Physical Labs Deficiency</h2>
@if (TempData["Error"] != null)
{
    <div class="error">
        <p><strong>Error:</strong> @TempData["Error"].ToString()</p>
    </div>
}

@if (TempData["Success"] != null)
{
    <div class="success">
        <p><strong>Success:</strong> @TempData["Success"].ToString()</p>
    </div>
}

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>


@using (Html.BeginForm("PhysicalLabsUploading", "FacultyVerification", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <table style="width: 100%; border: 1px; border-color: red" id="listequipment" class="webGrid">
        <thead>
        <tr>
            <th class="col13">S.No</th>
            <th class="col13">Department</th>
            <th class="col13">Lab Name</th>
            <th class="col13">Required</th>
            <th class="col13">Available Extra Labs</th>
            <th class="col13">Deficiency</th>
        </tr>
        </thead>
        @if (Model.Count != 0)
        {
            <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td class="col24">@(index++)</td>
                    <td class="col24">@item.DepartmentName</td>
                    <td class="col24">@item.Labname</td>
                    <td class="col24"><span>@item.NoofRequeried</span></td>
                    <td class="col24">@item.NoofAvailable</td>
                    <td class="col24"><span>Yes</span></td>
                </tr>

            }
            <tr>
                <td colspan="2" class="col24"><b>Supporting Document</b></td>
                <td colspan="3" class="col24 PhysicalLabsuploadings">
                    @Html.TextBoxFor(model => model[0].PhysicalLabsuploading, new {@type = "file", @required = "true", @id = "PhysicalLabsuploading", @class = "PhysicalLabsuploading"})
                    <br/>
                    <span style="color: red;"></span>
                </td>
                <td class="col24">
                    @if (!String.IsNullOrEmpty(Model[0].PhysicalLabUploadingview))
                    {
                        <a href="../@Model[0].PhysicalLabUploadingview.Replace("~", "")" target="_blank">
                            <span style="font-weight:bold;color:red">View</span>
                        </a>
                    }
                </td>
            </tr>
            </tbody>
        }
        else
        {
            <tbody>
            <tr>
                <td class="col24" colspan="6" style="text-align: center"><b>NIL</b></td>
            </tr>
            </tbody>
        }
    </table>
    <p style="text-align: right">
        @if (Model.Count != 0)
        {
            <input type="submit" value="Submit"/>
        }
    </p>
}
<br/>


<script type="text/javascript">

    $(document).ready(function() {
        
       

    });
    $(function () {
        $(".PhysicalLabsuploading").change(function () {

            var file = getNameFromPath($(this).val());
            var flag;
            if (file != null) {
                var extension = file.substr((file.lastIndexOf('.') + 1));
                switch (extension) {

                    case 'pdf':
                    case 'PDF':

                        flag = true;
                        break;
                    default:
                        flag = false;
                }
            }

            if (flag == false) {
                $(".PhysicalLabsuploadings > span").text("You can upload only  PDF files");
                $(this).val('');
                return false;
            }
            else {
                var size = GetNotificationFileSize(file);
                size = size / 1048576;
                if (size > 1) {
                    $(".PhysicalLabsuploadings > span").text("Document should not exceed 1 MB in Size");
                    $(this).val('');
                }
                else {

                    $(".PhysicalLabsuploadings > span").text("");
                }
            }

        });
    });


    //get file path from client system
    function getNameFromPath(strFilepath) {
        var objRE = new RegExp(/([^\/\\]+)$/);
        var strName = objRE.exec(strFilepath);

        if (strName == null) {
            return null;
        }
        else {
            return strName[0];
        }
    }


    //get file size
    function GetNotificationFileSize(fileid) {
        try {
            var fileSize = 0;
            //for IE
            if ($.browser.msie) {
                //before making an object of ActiveXObject, //please make sure ActiveX is enabled in your IE browser
                var objFSO = new ActiveXObject("Scripting.FileSystemObject"); var filePath = $("#" + fileid)[0].value;
                var objFile = objFSO.getFile(filePath);
                var fileSize = objFile.size; //size in kb
                //alert(fileSize);
                //fileSize = fileSize / 1048576; //size in mb
                // fileSize = fileSize / 1048576; //size in mb
                alert(fileSize);
            }
                //for FF, Safari, Opeara and Others
            else {
                fileSize = $("#PhysicalLabsuploading")[0].files[0].size; //size in kb
                //fileSize = fileSize / 1048576; //size in mb
            }
            return fileSize;
        }
        catch (e) {

            //alert("Error is : " + e);
        }
    }




</script>