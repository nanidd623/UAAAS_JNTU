@model UAAAS.Models.CollegeFaculty
@{
    if (ViewBag.FacultyType == 1)
    {
        ViewBag.Title = "Add Teaching Faculty";
    }
    else if (ViewBag.FacultyType == 3)
    {
        ViewBag.Title = "Add Non-Teaching Staff";
    }
    else if (ViewBag.FacultyType == 2)
    {
        ViewBag.Title = "Add Technical Staff";
    }
    Layout = "~/Views/Shared/_LayoutLeftMenu.cshtml";
}

@if (ViewBag.FacultyType == 1)
{
    <h2>Add Teaching Faculty</h2>

    if (ViewBag.DegreeCount == 0)
    {
        <div class="warning" style="width: 550px; margin: 0 auto;">
            <p>Please select your courses in "College Information" page before filling up this page. Otherwise you can not select degrees while adding faculty Subjects</p>
        </div>
    }
}
else if (ViewBag.FacultyType == 3)
{
    <h2>Add Non-Teaching Faculty</h2>
}
else if (ViewBag.FacultyType == 2)
{
    <h2>Add Technical Faculty</h2>
    if (ViewBag.DegreeCount == 0)
    {
        <div class="warning" style="width: 550px; margin: 0 auto;">
            <p>Please select your courses in "College Information" page before filling up this page. Otherwise you can not select degrees while adding faculty Labs</p>
        </div>
    }
}
<p class="create_link_right">
    <input name="btnPrint" type="button" onclick="printdiv('div_print');" value=" Print" class="create_button">
</p>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Validations.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {

        $(".ratifed").hide();
        $("#isFacultyRatifiedByJNTU").live("click", function () {
            var selectedValue = $(this).val();
            if (selectedValue == 'True') {
                $(".ratifed").show();
            }
            else { $(".ratifed").hide(); }
        });

        if ($("#isFacultyRatifiedByJNTU").val() == 'True') {
            $(".ratifed").show();
        }



        $('.submit').click(function (event, args) {
            if ($('#photo').val() == undefined && $('#facultyPhoto').val() == '') {
                alert("Please select photo")
                return false;
            }
            else {
                return true;
            }

            $("#isFacultyRatifiedByJNTU").live("click", function () {
                var selectedValue = $(this).val();
                if (selectedValue == 'True') {
                    if ($("#facultyDateOfRatification").val() == '') {
                        args.isValid = false;
                    }

                    if ($("#facultyDurationOfRatification").val() == '') {
                        args.isValid = false;
                    }
                }
            });
            checkDateDifference($('#facultyDateOfAppointment').val(), $('#facultyDateOfRatification').val(), "Date of Appointment should not be grater than (or) equal to Date Of Resignation");
        });
    });

    function checkDateDifference(startDate, endDate, alertString) {

        if ((startDate != null && startDate != '') && (endDate != null && endDate != '')) {
            startDate = $.datepicker.parseDate('dd/mm/yy', startDate);
            endDate = $.datepicker.parseDate('dd/mm/yy', endDate);
            var difference = (endDate - startDate) / (86400000);
            if (difference < 0) {
                alert(alertString);
                dateFlag = 0;
                return false;
            }
            else {
                dateFlag = 1;
                return true;
            }
        }
        else {
            dateFlag = 1;
            return true;
        }

    }


    function printdiv(printpage)
    {
        //Get the HTML of div
        var divElements = document.getElementById(printpage).innerHTML;
        //Get the HTML of whole page
        var oldPage = document.body.innerHTML;

        //Reset the page's HTML with div's HTML only
        document.body.innerHTML =
          "<html><head><title></title></head><body>" +
          divElements.fontsize(1) + "</body>";

        //Print Page
        window.print();

        //Restore orignal HTML
        document.body.innerHTML = oldPage;
        return false;
    }
</script>
<div id="div_print">
    @using (Html.BeginForm("Create", "CollegeFaculty", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {

        if (TempData["Error"] != null)
        {
            <div class="error">
                <p><strong>Error:</strong> @TempData["Error"].ToString()</p>
            </div>
        }
        if (TempData["Success"] != null)
        {
            <div class="success">
                <p><strong>Success:</strong> @TempData["Success"].ToString()</p>
            </div>
        }

        @Html.HiddenFor(model => model.collegeId)
        @Html.HiddenFor(model => model.facultyTypeId)
        @Html.HiddenFor(model => model.createdBy)
        @Html.HiddenFor(model => model.createdOn)

        <table class="faculty_table">
            <tr>
                <td class="col11" colspan="4">
                    <b>Personal Information</b>
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyFirstName)
                </td>
                <td class="col21 focus">
                    @Html.DisplayFor(model => model.facultyFirstName)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultyLastName)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultyLastName)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultySurname)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultySurname)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultyFatherName)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultyFatherName)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyGenderId)
                </td>
                <td class="col21">
                    @if (Model.facultyGenderId == 1)
                    {
                        <label>Male</label>
                    }
                    else
                    {
                        <label>Female</label>
                    }
                    @Html.HiddenFor(model => model.facultyGenderId)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.dateOfBirth)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.dateOfBirth, new { @class = "calendar1", style = "width: 80px", @onblur = "IsValidDate(this,event.keyCode,0,0,0)", @onkeydown = "return IsValidFormat(this,event.keyCode)" }) (DD/MM/YYYY)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyPhoto)
                </td>
                <td class="col21 files">
                    @Html.DisplayFor(model => model.facultyPhoto, new { type = "file", @class = "file" })
                    <br />
                    <span style="color: red;"></span>

                    @if (@Model.photo != null)
                    {<br />
                        <img src="@Model.photo.Replace("~", "")" style="width: 100px;" />
                        @Html.HiddenFor(model => model.photo)
                    }
                </td>
                @if (ViewBag.FacultyType == 1)
                {
                    <td class="col3">@Html.LabelFor(model => model.facultyRecruitedFor)</td>
                    <td class="col4">
                        @Html.DisplayFor(model => model.facultyRecruitedFor)
                    </td>
                }
                else
                {
                    <td class="col3"></td>
                    <td class="col4"></td>
                }
            </tr>
        </table>
        <br />
        <table class="faculty_table">
            <tr>
                <td class="col11" colspan="4">
                    <b>Professional Information</b>
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyDepartmentId)
                </td>
                <td class="col21">
                    @ViewBag.FacultyDepartmentName
                    @Html.HiddenFor(model => model.facultyDepartmentId)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultyCategoryId)
                </td>
                <td class="col41">
                    @ViewBag.FacultyCategoryName
                    @Html.HiddenFor(model => model.facultyCategoryId)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyDesignationId)
                </td>
                <td class="col21">
                    @ViewBag.FacultyDesignation
                    @Html.HiddenFor(model => model.facultyDesignationId)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultyOtherDesignation)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultyOtherDesignation)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.dateOfAppointment)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.dateOfAppointment, new { @class = "calendar1", style = "width: 80px", @onblur = "IsValidDate(this,event.keyCode,0,0,1)", @onkeydown = "return IsValidFormat(this,event.keyCode)" }) (DD/MM/YYYY)
                </td>
                <td class="col31">
                    @if (ViewBag.FacultyID > 0)
                    {
                        @Html.LabelFor(model => model.dateOfResignation)
                    }
                </td>
                <td class="col41">
                    @if (ViewBag.FacultyID > 0)
                    {
                        @Html.DisplayFor(model => model.dateOfResignation, new { @class = "calendar1", style = "width: 80px", @onblur = "IsValidDate(this,event.keyCode,0,0,1)", @onkeydown = "return IsValidFormat(this,event.keyCode)" }) <span>(DD/MM/YYYY)</span>
                    }
                </td>
            </tr>
            @if (ViewBag.FacultyType == 1)
            {
                <tr>
                    <td class="col11">
                        @Html.LabelFor(model => model.isFacultyRatifiedByJNTU)
                    </td>
                    <td class="col21">
                        @if (Model.isFacultyRatifiedByJNTU == true)
                        {
                            <label>Yes</label>
                        }
                        else
                        {
                            <label>No</label>
                        }
                        @Html.HiddenFor(model => model.isFacultyRatifiedByJNTU)
                    </td>
                    <td class="col31">
                        <div class="ratifed">
                            @Html.LabelFor(model => model.dateOfRatification)
                            <div style="height: 5px;">
                            </div>
                            @Html.LabelFor(model => model.facultyDurationOfRatification) <span>(years)</span>
                        </div>
                    </td>
                    <td class="col41">
                        <div class="ratifed">
                            @Html.DisplayFor(model => model.dateOfRatification, new { @class = "calendar1", style = "width: 80px", @onblur = "IsValidDate(this,event.keyCode,0,0,1)", @onkeydown = "return IsValidFormat(this,event.keyCode)" }) <span>(DD/MM/YYYY)</span>
                            <div style="height: 3px;">
                            </div>
                            @Html.DisplayFor(model => model.facultyDurationOfRatification)
                        </div>
                    </td>
                </tr>
            }
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyPayScale)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultyPayScale)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultySalary)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultySalary)
                </td>

            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.grossSalary)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.grossSalary)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.netSalary)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.netSalary)
                </td>

            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.salaryAccountNumber)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.salaryAccountNumber)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.salaryBankName)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.salaryBankName)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.salaryBranchName)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.salaryBranchName)
                </td>
                <td class="col31">@Html.LabelFor(model => model.facultyPreviousExperience) (years)</td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultyPreviousExperience)
                </td>

            </tr>
        </table>
        <br />
        <table class="faculty_table">
            <tr>
                <td class="col11" colspan="4">
                    <b>Contact Information</b>
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyMobile)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultyMobile)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultyEmail)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultyEmail)
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyPANNumber)
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultyPANNumber)
                </td>
                <td class="col31">
                    @Html.LabelFor(model => model.facultyAadhaarNumber)
                </td>
                <td class="col41">
                    @Html.DisplayFor(model => model.facultyAadhaarNumber)
                </td>
            </tr>
        </table>
        <br />
        <table class="faculty_table">
            <tr>
                <td class="col11" colspan="4">
                    <b>Other Information</b>
                </td>
            </tr>
            <tr>
                <td class="col11" colspan="3">
                    @Html.LabelFor(model => model.isRelatedToExamBranch)
                </td>
                <td class="col41">
                    @if (Model.isRelatedToExamBranch == true)
                    {
                        <label>Yes</label>
                    }
                    else
                    {
                        <label>No</label>
                    }
                </td>
            </tr>
            <tr>
                <td class="col11" colspan="3">
                    @Html.LabelFor(model => model.isRelatedToPlacementCell)
                </td>
                <td class="col41">
                    @if (Model.isRelatedToPlacementCell == true)
                    {
                        <label>Yes</label>
                    }
                    else
                    {
                        <label>No</label>
                    }
                </td>
            </tr>
        </table>
        <br />
        <table class="faculty_table" style="display:none;">
            <tr>
                <td class="col11" colspan="2">
                    <b>Achievements (if any)</b>
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyAchievements1) 1
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultyAchievements1, new { style = "width: 95%;" })
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyAchievements2) 2
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultyAchievements2, new { style = "width: 95%;" })
                </td>
            </tr>
            <tr>
                <td class="col11">
                    @Html.LabelFor(model => model.facultyAchievements3) 3
                </td>
                <td class="col21">
                    @Html.DisplayFor(model => model.facultyAchievements3, new { style = "width: 95%;" })
                </td>
            </tr>
        </table>
        <br />
        <table class="faculty_table">
            <tr>
                <td class="col11" colspan="7">
                    <b>Educational Qualifications</b>
                </td>
            </tr>
            <tr>
                <td class="col11" style="text-align: center; width: 100px;"></td>
                <td class="col11" style="text-align: center; width: 130px;">Course Studied</td>
                <td class="col11" style="text-align: center; width: 90px;">Year of Passing (YYYY)</td>
                <td class="col11" style="text-align: center; width: 70px;">% of Marks / CGPA</td>
                <td class="col11" style="text-align: center; width: 90px;">Division</td>
                <td class="col11" style="text-align: center;">Board/University</td>
                <td class="col11" style="text-align: center; width: 220px;">Place</td>
            </tr>
            @for (int i = 0; i < Model.FacultyEducation.Count(); i++)
            {
                var style = "alt_row";
                var year = "yr_" + i;
                var divs = "division_" + i;

                <tr>
                    <td class="col21" style="text-align: left;">
                        @Html.DisplayFor(model => model.FacultyEducation[i].educationName)
                        @Html.HiddenFor(model => model.FacultyEducation[i].educationName)
                        @Html.HiddenFor(model => model.FacultyEducation[i].educationId)
                    </td>
                    <td class="col21" style="text-align: center;">
                        @Html.DisplayFor(model => model.FacultyEducation[i].studiedEducation, new { style = "width: 90%" })
                    </td>
                    <td class="col21" style="text-align: center;">
                        @Html.DisplayFor(model => model.FacultyEducation[i].passedYear, new { style = "width: 85%" })
                    </td>
                    <td class="col21" style="text-align: center;">@Html.DisplayFor(model => model.FacultyEducation[i].percentage, new { style = "width: 85%; text-align: center;", Value = Model.FacultyEducation[i].percentage == 0 ? string.Empty : Model.FacultyEducation[i].percentage.ToString() })</td>
                    <td class="col21" style="text-align: center;">
                        @Html.DisplayFor(model => model.FacultyEducation[i].division, new { style = "width: 85%; text-align: center;" })
                    </td>
                    <td class="col21" style="text-align: center;">@Html.DisplayFor(model => model.FacultyEducation[i].university, new { style = "width: 95%" })</td>
                    <td class="col21" style="text-align: center;">@Html.DisplayFor(model => model.FacultyEducation[i].place, new { style = "width: 90%" })</td>
                </tr>
            }
        </table>
        <br />
        if (ViewBag.FacultyType == 1 || ViewBag.FacultyType == 2)
        {
            <table class="faculty_table">
                <tr>
                    <td class="col11" colspan="7">
                        @if (ViewBag.FacultyType == 1)
                        {
                            <b>Subjects being taught as per college time – table :</b>
                        }
                        @if (ViewBag.FacultyType == 2)
                        {
                            <b>Labs being conduct as per college time – table :</b>
                        }
                    </td>
                </tr>
                <tr>
                    <td class="col11" style="text-align: center; width: 30px;">S.No</td>
                    <td class="col11" style="text-align: center; width: 100px;">Degree</td>
                    <td class="col11" style="text-align: center; width: 150px;">Department</td>
                    <td class="col11" style="text-align: center; width: 150px;">Specialization</td>
                    <td class="col11" style="text-align: center; width: 50px;">Shift</td>
                    <td class="col11" style="text-align: center;">
                        @if (ViewBag.FacultyType == 1)
                        {
                            <span>Subject Name</span>
                        }
                        @if (ViewBag.FacultyType == 2)
                        {
                            <span>Lab Name</span>
                        }
                    </td>
                    <td class="col11" style="text-align: center; width: 100px;">Duration (Minutes / week)</td>
                </tr>
                @for (int i = 0; i < Model.FacultySubject.Count(); i++)
                {
                    var style = "alt_row";
                    var deg = "degree_" + i;
                    var dep = "department_" + i; var depName = "depName_" + i;
                    var spec = "specialization_" + i; var specName = "specName_" + i;
                    var shift = "shift_" + i; var shiftName = "shiftName_" + i;

                    <tr>
                        <td class="col21" style="text-align: center;">@(i + 1).</td>
                        <td class="col21" style="text-align: left;">
                            @Html.DisplayFor(model => model.FacultySubject[i].degreeName)
                        </td>
                        <td class="col21" style="text-align: center;">
                            @Html.DisplayFor(model => model.FacultySubject[i].departmentName)
                        </td>
                        <td class="col21" style="text-align: center;">
                            @Html.DisplayFor(model => model.FacultySubject[i].specializationName)
                        </td>
                        <td class="col21" style="text-align: center;">
                            @Html.DisplayFor(model => model.FacultySubject[i].shiftName)

                        </td>
                        <td class="col21" style="text-align: center;">@Html.DisplayFor(model => model.FacultySubject[i].subject, new { style = "width: 95%" })</td>
                        <td class="col21" style="text-align: center;">@Html.DisplayFor(model => model.FacultySubject[i].duration, new { style = "width: 90%" })</td>
                    </tr>

                    <script type="text/javascript">

                        $(document).ready(function () {

                            if(@ViewBag.FacultyID > 0)
                            {
                                if(@Model.FacultySubject[i].degreeId != null)
                                {
                                    $("#@deg").val(@Model.FacultySubject[i].degreeId);
                                }

                                if(@Model.FacultySubject[i].shiftId > 0)
                                {
                                    $("#@shift").val(@Model.FacultySubject[i].shiftId);
                                }
                            }

                            if ($("#@deg").val() > 0) {
                                GetDepartments($("#@deg").val());
                            }

                            $("#@deg").change(function () {
                                var DegreeID = $(this).val();
                                GetDepartments(DegreeID);
                            });

                            if ($("#@dep").val() > 0) {
                                GetSpecialization($("#@dep").val());
                            }

                            $("#@dep").change(function () {
                                var DepartmentID = $(this).val();
                                GetSpecialization(DepartmentID);
                            });

                            function GetDepartments(DegreeID) {

                                $.getJSON("/CollegeIntakeProposed/GetDepartments", { id: DegreeID },
                                    function (DepartmentsData) {
                                        var select = $("#@dep");
                                        select.empty();
                                        select.append($('<option/>', {
                                            value: '',
                                            text: '-- Select --'
                                        }));

                                        if(@ViewBag.FacultyID > 0)
                                        {

                                            $.each(DepartmentsData, function (index, itemdata) {
                                                select.append($('<option/>', {
                                                    value: itemdata.Value,
                                                    text: itemdata.Text,
                                                    selected: (itemdata.Value == @Model.FacultySubject[i].departmentId  ? true : false)
                                                }));
                                            });

                                        }
                                        else
                                        {
                                            $.each(DepartmentsData, function (index, itemdata) {
                                                select.append($('<option/>', {
                                                    value: itemdata.Value,
                                                    text: itemdata.Text
                                                }));
                                            });
                                        }
                                        if ($("#@dep").val() > 0) {
                                            GetSpecialization($("#@dep").val());
                                        }
                                    });
                            }

                            function GetSpecialization(DepartmantID) {
                                $.getJSON("/CollegeIntakeProposed/GetSpecialization", { id: DepartmantID },
                                    function (Specializationdata) {
                                        var select = $("#@spec");
                                        select.empty();
                                        select.append($('<option/>', {
                                            value: '',
                                            text: '-- Select --'
                                        }));
                                        if(@ViewBag.FacultyID > 0)
                                        {
                                            $.each(Specializationdata, function (index, itemdata) {
                                                select.append($('<option/>', {
                                                    value: itemdata.Value,
                                                    text: itemdata.Text,
                                                    selected: (itemdata.Value == @Model.FacultySubject[i].specializationId ? true : false)
                                                }));
                                            });
                                        }
                                        else
                                        {
                                            $.each(Specializationdata, function (index, itemdata) {
                                                select.append($('<option/>', {
                                                    value: itemdata.Value,
                                                    text: itemdata.Text
                                                }));
                                            });
                                        }
                                    });
                            }
                        });
                    </script>
                }
            </table>
        }
    }
</div>