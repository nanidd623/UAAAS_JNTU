@model UAAAS.Controllers.OnlineRegistration.FacultyDeclaration
@{
    ViewBag.Title = "FacultyDeclarationview";
}

<h2>FacultyDeclarationview</h2>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/Validations.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jspdf.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jspdf.plugin.from_html.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {

        $(".UploadDeclaration").change(function () {
            var file = getNameFromPath($(this).val());
            //var file = $('.UploadDeclaration').val();
            var flag;
            if (file != null) {
                var extension = file.substr((file.lastIndexOf('.') + 1));
                switch (extension) {
                    case 'pdf':
                    case 'PDF':
                        flag = true;
                        break;
                    default:
                        flag = false;
                }
            }

            if (flag == false) {
                alert("You can upload only  PDF files");
                $(this).val('');
                return false;
            } else {
               
                var size = GetFileSize(file, "UploadDeclaration");
                
                size = size / 1048576;
                if (size > 1) {
                    alert("Document should not exceed 1 MB in Size");
                    $(this).val('');
                } else {
                    $(".UploadDeclaration > span").text("");
                }
            }

        });

        function GetFileSize(fileid, title) {

            try {
                var fileSize = 0;
                //for IE
                if ($.browser.msie) {
                    //before making an object of ActiveXObject,
                    //please make sure ActiveX is enabled in your IE browser
                    var objFSO = new ActiveXObject("Scripting.FileSystemObject");
                    var filePath = $("#" + fileid)[0].value;
                    var objFile = objFSO.getFile(filePath);
                    var fileSize = objFile.size; //size in kb
                    //fileSize = fileSize / 1048576; //size in mb
                }
                    //for FF, Safari, Opeara and Others
                else {
                    fileSize = $("#Declarationfile")[0].files[0].size; //size in kb
                    //fileSize = fileSize / 1048576; //size in mb
                }

                return fileSize;
            } catch (e) {

                //alert("Error is : " + e);
            }
        }

        //get file path from client system
        function getNameFromPath(strFilepath) {
            var objRE = new RegExp(/([^\/\\]+)$/);
            var strName = objRE.exec(strFilepath);

            if (strName == null) {
                return null;
            } else {
                return strName[0];
            }
        }
    });
</script>
@using (Html.BeginForm("UploadFacultydeclaration", "NewOnlineRegistration", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <div>
        <table class="faculty_table" style="text-align: center; width: 100%">
            <tr>
                <td class="col1">
                    <span>Registration Number</span>
                </td>
                <td class="col2">
                    @Html.DisplayFor(model => model.RegistrationNumber)
                    @Html.HiddenFor(model => model.RegistrationNumber)
                    @Html.HiddenFor(model => model.FacultyId)
                </td>
                <td class="col3"><span>Faculty Name</span></td>
                <td class="col4">
                    &nbsp; @Html.DisplayFor(model => model.Name)
                    @Html.HiddenFor(model => model.Name)
                </td>
            </tr>
            <tr>
                <td class="col1">Pan Number</td>
                <td class="col2" style="width:35%;height:18px;">
                    &nbsp; @Html.DisplayFor(model => model.Pannumber)
                    @Html.HiddenFor(model => model.Pannumber)
                </td>
                <td class="col3">DOJ</td>
                <td class="col4">
                    &nbsp;
                    @Html.DisplayFor(model => model.FacultyDOJ)
                    @Html.HiddenFor(model => model.FacultyDOJ)

                </td>
            </tr>
            <tr>
                <td class="col1">College Name</td>
                <td class="col2" colspan="3">
                    &nbsp; @Html.DisplayFor(model => model.collegeName)
                    @Html.HiddenFor(model => model.collegeName)
                </td>
            </tr>
            <tr>
                <td class="col1">Department Name</td>
                <td class="col2">
                    &nbsp; @Html.DisplayFor(model => model.Department)
                    @Html.HiddenFor(model => model.Department)
                </td>
                <td class="col3">Designation</td>
                <td class="col4">
                    &nbsp; @Html.DisplayFor(model => model.Designation)
                    @Html.HiddenFor(model => model.Designation)
                </td>
            </tr>
            @if (Model.Facultytype == 2)
            {
                <tr>
                    <td class="col1">Releving Date</td>
                    <td class="col2">
                        &nbsp; @Html.DisplayFor(model => model.FacultyReleving)
                        @Html.HiddenFor(model => model.FacultyReleving)
                    </td>
                    <td class="col3">New College Joining Date</td>
                    <td class="col4">
                        &nbsp; @Html.DisplayFor(model => model.FacultyNewleyDOJ)
                        @Html.HiddenFor(model => model.FacultyNewleyDOJ)
                    </td>
                </tr>
                <tr>
                    <td class="col1">College Name</td>
                    <td class="col2" colspan="3">
                        &nbsp; @Html.DisplayFor(model => model.NewcollegeName)
                        @Html.HiddenFor(model => model.NewcollegeName)
                    </td>
                </tr>
            }
            @if (Model.Facultytype == 3)
            {
                <tr>
                    <td class="col1">Releving Date</td>
                    <td class="col2">
                        &nbsp; @Html.DisplayFor(model => model.FacultyReleving)
                        @Html.HiddenFor(model => model.FacultyReleving)
                    </td>
                    <td class="col3">Reason</td>
                    <td class="col4">
                        &nbsp; @Html.DisplayFor(model => model.Reason)
                        @Html.HiddenFor(model => model.Reason)
                    </td>
                </tr>

            }
            <tr>
                <td class="col1"> Faculty Declaration</td>
                <td class="col2">
                   

                    @if (!string.IsNullOrEmpty(Model.UploadedDeclaration))
                    {
                        <a href="~/Content/Upload/Faculty/FacultyDeclarations/@Model.UploadedDeclaration" target="_blank">
                            <span style="color: red;"><b>View</b></span>
                        </a>
                    }
                    else
                    {
                        @Html.TextBoxFor(model => model.Declarationfile, new { @type = "file", @class = "UploadDeclaration" })
                    }
                </td>
                <td class="col3" colspan="2">
                    @if (string.IsNullOrEmpty(Model.UploadedDeclaration))
                    {
                        <input type="submit" id="Upload" name="Upload" value="Upload" />
                    }

                    @*@Html.ActionLink("Upload", "UploadFacultydeclaration", "NewOnlineRegistration", new { strfacultyId = UAAAS.Models.Utilities.EncryptString(Model.FacultyId.ToString(), System.Web.Configuration.WebConfigurationManager.AppSettings["CryptoKey"]), reg = Model.Declarationfile }, new { @class = "create_button" })*@

                </td>
            </tr>
            <tr>
                <td colspan="4" style="text-align:right">
                    <br />
                    @Html.ActionLink("Print", "FacultydeclarationData", "NewOnlineRegistration", new { strfacultyId = UAAAS.Models.Utilities.EncryptString(Model.FacultyId.ToString(), System.Web.Configuration.WebConfigurationManager.AppSettings["CryptoKey"]), reg = Model.RegistrationNumber }, new { @class = "create_button" })
                </td>
            </tr>
        </table>

    </div>
}
