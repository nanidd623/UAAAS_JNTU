@{
    ViewBag.Title = "ViewTeachingStaff";
    Layout = "~/Views/Shared/_LayoutLeftMenu.cshtml";
    var index = 1;

    string facultyid = string.Empty;
}

<h2>Teaching Faculty</h2>
<html>
<head>
    <title></title>


</head>
<body>
    <p class="create_link_right">
        @*@Html.ActionLink("Add Teaching Faculty", "AddFaculty", "Faculty", new { type = ViewBag.Type, fid = DBNull.Value, collegeId = @ViewBag.collegeId }, new { @id = "openDialog", @class = "create_button" })*@
    </p>

    @if (TempData["Error"] != null)
    {
        <div class="error">
            <p><strong>Error:</strong> @TempData["Error"].ToString()</p>
        </div>
    }
    @if (TempData["Success"] != null)
    {
        <div class="success">
            <p><strong>Success:</strong> @TempData["Success"].ToString()</p>
        </div>
    }

    @*@if (ViewBag.Admin == true)*@
    @if (Roles.IsUserInRole("Admin") == true)
    {
        <p class="create_link_right">
            @*@Html.ActionLink("Downloadpdf", "printpdfdata", "Faculty", new { strType = "Pdf" }, new { @class = "convertPdf create_button" })
            <input name="btnPrint" type="button" onclick=" printAdmindiv('div_Admin_print'); " value=" Print" class="create_button" />*@
            @*@Html.ActionLink("Export", "ViewTeaching", "Faculty", new { strType = "Export" }, new { @class = "create_button" })*@
            @Html.ActionLink("Export", "Export", "Faculty", new { id = @ViewBag.collegeId, strType = "Export" }, new { @class = "convertPdf create_button" })
        </p>
    }
    else
    {
        <p class="create_link_right">
            @* <input name="btnPrint" type="button" onclick="printdiv('div_print');" value=" Print" class="create_button">
                @Html.ActionLink("Print", "PrintTeaching", "Faculty", new { @class = "create_button" })*@

        </p>
    }
    <table id="example" class="display">
        <thead style="background: #FCF1D1">
            <tr>
                <th style="text-align: left;">S.No</th>
                <th style="text-align: left;">Name</th>
                <th style="text-align: left;">Registration Number</th>
                <th style="text-align: left;">Designation</th>
                <th style="text-align: left;">Department</th>
                <th style="text-align: left;">Specialization</th>
                <th style="text-align: left;">View</th>
                <th style="text-align: left;">Apply Leave</th>
                @*<th style="text-align: left;">Faculty Tracking</th>*@
                @*<th class="ui-state-default" style="width: 150px; text-align: center;">Verification Status</th>*@
                @*<th style="text-align: left;">Pending Status</th>*@


            </tr>
        </thead>

        @*<tfoot style="display:table-header-group">
            <tr>
                <th></th>
                <th style="text-align: left;">Name</th>
                <th style="text-align: left;">Registration Number</th>
                <th style="text-align: left;">Designation</th>
                <th style="text-align: left;">Department</th>
                <th style="text-align: left;">Specialization</th>
                <th></th>
            </tr>
            </tfoot>*@
        <tbody> </tbody>

    </table>
</body>

</html>
<div id="dialog-edit" style="display: none">
</div>
<div id="dialog-confirm" style="display:none">
    <p>
        <span class="ui-icon ui-icon-alert" style="float: left; margin: 0 7px 20px 0;"></span>
        Are you sure to delete ?
    </p>
</div>

<link type="text/css" rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />
<script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>
<script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css" />


<script type="text/javascript"> </script>
<script>
    // var asInitVals = new Array();
    $(document).ready(function () {
        var query = window.location.pathname.split("/");
        var id = query[3];
        console.log(query);
        console.log(id);
        // datatable
        var otable = $('#example').DataTable({
            "processing": true,
            //"serverSide": true,
            "ajax":
            {
                "type": "POST",
                "url": "/Faculty/ViewTeachingJson?id=" + id,
                "dataSrc": ""

            },
            // "order": [[ 1, 'asc' ]],
            "columns": [
                { "data": "id" },
                { "data": "facultyFirstName" },
                { "data": "FacultyRegistrationNumber" },
                { "data": "designation" },
                { "data": "department" },
                { "data": "SpecializationName" },

                //  {
                //     "data": "facultyPhoto",
                //    "bSortable": false,
                //    "render": function (data, type, row) {
                //       var path = "imagepath" + data;
                //       return '<img style="height:40px;text-align:center" src="' + path + '" />';
                //   }
                // },
                //{
                //    "data": "RegistrationNumber",
                //    "bSortable": false,
                {

                    "render": function (data, type, full) {
                        //debugger;
                        console.log(full);
                        return '<a href="/NewOnlineRegistration/CollegeViewFacultyDetails?fid=' + full["sfacid"] + ' " target="_blank" class="view_button"><span>View</span></a>';
                    }



                }
                ,
                {
                    "render": function (data, type, full) {
                        //debugger;
                        if (full["BlackList"] === null || full["BlackList"] === false) {
                            console.log(full);
                            return '<a href="/CollegeFacultyLeaves/Index?fid=' + full["sfacid"] + ' " target="_blank" class="edit_button"><span>Applyleave</span></a>';
                        } else {
                            return '<a><span>---</span></a>';

                        }
                    }
                }
                //,
                //{
                //    "render": function (data, type, full) {
                //        //debugger;
                //        if (full["IsFacultyTracking"] === true) {
                //            console.log(full);
                //            return '<a href="/Faculty/ViewFacultyTracking?regNum=' + full["RegNum"] + '&facName=' + full["FacName"] + ' " target="_blank" class="view_button"><span>ViewFacultyTracking</span></a>';
                //        } else {
                //            return '<a><span>---</span></a>';

                //        }
                //    }
                //}
                    //"render": function (data, type, full) {
                    //    debugger;
                    //    if (full["AdocFacultyRegistrationNumber"] === null) {
                    //        return '<a href="/Faculty/AdocFacultyRegistrationNumber?fid=' + full["id"] + '" class ="EditDialog edit_button" style="text-align:center"><span>Edit</span></a>';
                    //    } else {
                    //        return '<a href="/Faculty/AdocFacultyDelete?fid=' + full["adhocid"] + '&&type=' + full["AdhocfacultyTypeId"] + '&&rid=' + full["AdhocfacultyCategoryId"] + '"  class="confirmDialog delete_button"><span>Delete</span></a>';
                    //    }

                    //}

               //{
                   //"render": function (data, type, full) {
                   //    return '<a href="/Faculty/Delete?fid=' + full["id"] + '&&type=' + full["facultyTypeId"] + '&&rid=' + full["facultyCategoryId"] + '"  class="confirmDialog delete_button"><span>Delete</span></a>';
                   //}
               //}
            ],

            //who Faculty does not have Designation and Department ,It should be Red Color.
            //"createdRow": function (row, data, index) {
            //    debugger;
            //    if (data["designation"] === null || data["department"] === null) {
            //        $('td:eq(0)', row).css("background-color", "red");
            //    }
            //}



        });

        //$('#example tfoot tr th').each(function (i) {
        //    if (i !== 6 && i !== 9 && i !== 0) {
        //        var title = $(this).text();
        //        $(this).html('<input type="text" placeholder="" />');
        //    }
        //});
        //otable.columns().every(function () {
        //    var column = this;
        //    $('input', this.footer()).on('keyup change', function () { column.search(this.value).draw(); });
        //});
        otable.on('order.dt search.dt', function () {
            otable.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();


    });

    $(document).ready(function () {
        var mainUrl = window.location;

        var url;

        $.ajaxSetup({ cache: false });

        var $myDialog = $("#dialog-edit").dialog({
            title: 'Verify Faculty',
            autoOpen: false,
            resizable: false,
            height: 520,
            width: 640,
            show: { effect: 'drop', direction: "up" },
            modal: true,
            draggable: true,
            closeOnEscape: true,
            open: function (event, ui) {
                $(this).load(url);
            },
            close: function (event, ui) {
                $(this).dialog("close");
            }
        });

        $("#openDialog").live("click", function (e) {
            e.preventDefault();
            $("#dialog-edit").dialog({
                title: 'Add Faculty'
            });
            url = $("#openDialog").attr('href');
            $myDialog.dialog('open');
            return false;
        });

        $('.display').find('tr').click(function () {
            url = $(this).find(".editDialog").attr('href');
        });

        $(".editDialog").live("click", function (e) {
            e.preventDefault();
            $("#dialog-edit").dialog({
                title: 'Verify Faculty'
            });

            $myDialog.dialog('open');
            return false;
        });

        $("#btncancel").live("click", function (e) {
            $("#dialog-edit").dialog("close");
        });

        $($myDialog).bind("dialogclose", function () {
            window.location = mainUrl;
        });


        // For Deleting
        $(".confirmDialog").live("click", function (e) {
            var url = $(this).attr('href');
            $("#dialog-confirm").dialog({
                title: 'Delete Faculty',
                autoOpen: false,
                resizable: false,
                height: 170,
                width: 350,
                show: { effect: 'fadeIn', direction: "up" },
                modal: true,
                draggable: true,
                buttons: {
                    "Yes": function () {
                        $(this).dialog("close");
                        window.location = url;

                    },
                    "No": function () {
                        $(this).dialog("close");

                    }
                }
            });

            $("#dialog-confirm").dialog('open');
            return false;
        });


        $("#btncancel").live("click", function (e) {
            $("#dialog-edit").dialog("close");
        });

        $($myDialog).bind("dialogclose", function () {
            window.location = mainUrl;
        });

        $(".EditDialog").live("click", function (e) {

            var url = $(this).attr('href');

            $("#dialog-edit").dialog({
                title: 'Edit Faculty',
                autoOpen: false,
                resizable: false,
                height: 520,
                width: 640,
                show: { effect: 'drop', direction: "up" },
                modal: true,
                draggable: true,
                closeOnEscape: true,
                open: function (event, ui) {
                    $(this).load(url);
                },
                close: function (event, ui) {
                    window.location.href = "/Faculty/Teaching";
                }

            });

            $("#dialog-edit").dialog('open');
            return false;
        });
        $("#btneditcancel").live("click", function (e) {

            //$("#dialog-edit").close();
            window.location.href = "/Faculty/ViewTeaching";
        });
    });
</script>


<style>
    #example_wrapper .row {
        border: none;
    }

    #example_filter input[type=search] {
        border: solid 1px #c0c0c0;
        padding: 2px;
    }

    #example thead tr th, #example tfoot tr th {
        border: 1px solid #d3d3d3;
    }

    /*#example tbody tr td {
        text-align: center;
    }*/

    #example_wrapper {
        border: 1px solid #C0C0C0;
    }

    #example {
        padding-top: 10px;
    }

    .leave_button {
        background: url('../../Content/images/Leave-Management-System - Copy.png') no-repeat top left;
        display: inline-block;
        width: 35px;
        height: 35px;
        text-indent: -9999px;
    }
</style>












































@*Old Code chaning into JSOn Format Data*@


@*@model IEnumerable<UAAAS.Models.CollegeFaculty>
    @{
        ViewBag.Title = "Teaching Faculty";
        Layout = "~/Views/Shared/_LayoutLeftMenu.cshtml";
        var index = 1;
    }

    <h2>Teaching Faculty</h2>
    @section onReady{

        /* Initialize table and make first column non-sortable*/
        $('#example').dataTable({  "bJQueryUI": true,
        "iDisplayLength": 50,
        "bStateSave": false,
        "sDom": '<"top"lfip>rt<"bottom"ip<"clear">',
        "aoColumns": [ { "bSortable": true, "bSearchable": true }, null, null, null, null, null ]
        });
    }
    <script type="text/javascript">

        $(function () {
            $('.convertPdf').click(function () {
                var htmldata = $('#div_Admin_print').html().toString();

                $.ajax({
                    type: "POST",
                    url: '/Faculty/printpdf',
                    cache: false,
                    async: false,
                    data: '{htmldata:' + JSON.stringify(htmldata) + '}',
                    // data: { htmldata: dochtml },
                    dataType: "json",
                    timeout: 3000,
                    contentType: "application/json; charset=utf-8",
                    success: function (image) {
                    },
                    error: function (image) {
                        alert("Fail" + image.toString());
                        return false;
                    }
                })
            });

            //function Setdata() {
            //    var htmldata = $('#div_Admin_print').html().toString();

            //    return htmldata;
            //}
        });

        function printdiv(printpage) {
            $(".view_hide").hide();
            //Get the HTML of div
            var divElements = document.getElementById(printpage).innerHTML;
            //Get the HTML of whole page
            var oldPage = document.body.innerHTML;

            //Reset the page's HTML with div's HTML only
            document.body.innerHTML =
              "<html><head><title></title></head><body>" +
              divElements.fontsize(1) + "</body>";

            //Print Page
            window.print();

            //Restore orignal HTML
            document.body.innerHTML = oldPage;
            $(".view_hide").show();
            return false;
        }
        function printAdmindiv(printpage) {
            $(".isAdmin").show();
            $(".view_hide").hide();
            //Get the HTML of div
            var divElements = document.getElementById(printpage).innerHTML;
            //Get the HTML of whole page
            var oldPage = document.body.innerHTML;

            //Reset the page's HTML with div's HTML only
            document.body.innerHTML =
              "<html><head><title></title></head><body>" +
              divElements.fontsize(1) + "</body>";

            //Print Page
            window.print();

            //Restore orignal HTML
            document.body.innerHTML = oldPage;
            $(".view_hide").show();
            $(".isAdmin").hide();
            return false;
        }


        $(document).ready(function () {
            debugger;
            var mainUrl = window.location;

            var url;

            $.ajaxSetup({ cache: false });

            var $myDialog = $("#dialog-edit").dialog({
                title: 'Verify Faculty',
                autoOpen: false,
                resizable: false,
                height: 520,
                width: 640,
                show: { effect: 'drop', direction: "up" },
                modal: true,
                draggable: true,
                closeOnEscape: true,
                open: function (event, ui) {
                    $(this).load(url);
                },
                close: function (event, ui) {
                    $(this).dialog("close");
                }
            });

            $("#openDialog").live("click", function (e) {
                debugger;
                e.preventDefault();
                $("#dialog-edit").dialog({
                    title: 'Add Faculty'
                });
                url = $("#openDialog").attr('href');
                $myDialog.dialog('open');
                return false;
            });

            $('.display').find('tr').click(function () {
                url = $(this).find(".editDialog").attr('href');
            });

            $(".editDialog").live("click", function (e) {
                e.preventDefault();
                $("#dialog-edit").dialog({
                    title: 'Verify Faculty'
                });

                $myDialog.dialog('open');
                return false;
            });

            $("#btncancel").live("click", function (e) {
                $("#dialog-edit").dialog("close");
            });

            $($myDialog).bind("dialogclose", function () {
                window.location = mainUrl;
            });

            $(".confirmDialog").live("click", function (e) {

                var url = $(this).attr('href');

                $("#dialog-confirm").dialog({
                    title: 'Delete Faculty',
                    autoOpen: false,
                    resizable: false,
                    height: 170,
                    width: 350,
                    show: { effect: 'drop', direction: "up" },
                    modal: true,
                    draggable: true,
                    buttons: {
                        "Yes": function () {
                            $(this).dialog("close");
                            window.location = url;

                        },
                        "No": function () {
                            $(this).dialog("close");

                        }
                    }
                });

                $("#dialog-confirm").dialog('open');
                return false;
            });


            $("#btncancel").live("click", function (e) {
                $("#dialog-edit").dialog("close");
            });

            $($myDialog).bind("dialogclose", function () {
                window.location = mainUrl;
            });
        });
    </script>
    @Html.ActionLink("Add Teaching Faculty", "FacultyRegistrationNumber", "Faculty", new { type = ViewBag.Type, fid = DBNull.Value, collegeId = @ViewBag.collegeId }, new { @id = "openDialog", @class = "create_button" })
    @if (ViewBag.Admin == true)
    {
        <p class="create_link_right">
            @Html.ActionLink("Downloadpdf", "printpdfdata", "Faculty", new { strType = "Pdf" }, new { @class = "convertPdf create_button" })
            <input name="btnPrint" type="button" onclick="printAdmindiv('div_Admin_print');" value=" Print" class="create_button" />
            @Html.ActionLink("Export", "ViewTeaching", "Faculty", new { strType = "Export" }, new { @class = "create_button" })
        </p>
    }
    else
    {
        <p class="create_link_right">
            @* <input name="btnPrint" type="button" onclick="printdiv('div_print');" value=" Print" class="create_button">
                @Html.ActionLink("Print", "PrintTeaching", "Faculty", new { @class = "create_button" })@
        </p>
    }*@
@*@using (Html.BeginForm())
    {
        int count = 0;
        <div id="div_print">

            <table id="example" class="display">
                <thead>
                    <tr>
                        <th style="width: 50px; text-align: center;">
                            S.No
                        </th>
                        <th>
                            Name
                        </th>

                        <th style="width: 150px; text-align: left;">
                            Designation
                        </th>
                        <th style="width: 150px; text-align: left;">
                            Department
                        </th>
                        <th class="ui-state-default" style="width: 150px; text-align: center;">
                            Faculty Registration Number
                        </th>
                        @*<th class="ui-state-default" style="width: 150px; text-align: center;">
                            Verification Status
                        </th>@
                        <th style="width: 150px; text-align: center;">
                            Pending Status
                        </th>
                        <th class="ui-state-default view_hide" colspan="2">View</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td style="width: 50px; text-align: center;">
                                @(index++)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.facultyFirstName)
                                @Html.DisplayFor(modelItem => item.facultyLastName)
                                @Html.DisplayFor(modelItem => item.facultySurname)

                            </td>

                            <td style="text-align: left;">
                                @Html.DisplayFor(modelItem => item.designation)
                                @if (item.facultyOtherDesignation != null)
                                { <span>, @item.facultyOtherDesignation</span>}
                            </td>
                            <td style="text-align: left;">
                                @Html.DisplayFor(modelItem => item.department)
                            </td>
                            <td style="text-align: center;">
                                @Html.DisplayFor(modelItem => item.FacultyRegistrationNumber)
                                @@if (item.FacultyRegistrationNumber == "")
                                    {
                                        @Html.DisplayFor(modelItem => item.FacultyRegistrationNumber)
                                    }
                                    else
                                    {
                                        <span><a target="_blank" href="../OnlineRegistration/FacultyNew?fid=@encString">@Html.DisplayFor(modelItem => item.FacultyRegistrationNumber)</a></span>
                                    }@
                            </td>
                            @*<td style="text-align: center;">

                                @if (item.FacultyVerificationStatus == 2)
                                { <span style="color: red; font-weight: bold;"> NOT CONFIRMED</span>}


                                else if (item.facultyCount > 0 && (item.FacultyVerificationStatus == 3 || item.FacultyVerificationStatus == 0))
                                { <span style="color: red;  font-weight: bold; font-family:'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif">Verification Pending</span>}
                                else
                                { <span style="color: green;">CONFIRMED</span>}
                            </td>@
                            <td style="text-align: center;">
                                @@if (item.PANDeactivationReasion=="")
                                {
                                    @Html.DisplayFor(modelItem => item.PANDeactivationReasion)
                                }@
                               @if(item.Reason!="")
                               {
                                   <span>@item.Reason</span>
                               }
                                else
                                {
                                    <span style="color: black;">--</span>
                                }

                            </td>
                            <td style="width: 30px; text-align: center;" class="view_hide">
                                @if (!string.IsNullOrEmpty(item.FacultyRegistrationNumber))
                                {
                                    @Html.ActionLink("View", "ViewFacultyDetails", "Faculty", new { fid = UAAAS.Models.Utilities.EncryptString(item.id.ToString(), System.Web.Configuration.WebConfigurationManager.AppSettings["CryptoKey"]) }, new { @class = "edit_button1", target = "_blank" })
                                }
                                @*else
                                {
                                    @Html.ActionLink("Details", "View/" + @ViewContext.RouteData.Values["id"], "CollegeFaculty", new { type = ViewBag.Type, fid = UAAAS.Models.Utilities.EncryptString(item.id.ToString(), System.Web.Configuration.WebConfigurationManager.AppSettings["CryptoKey"]) }, new { @class = "edit_button1 view_hide" })
                                }
                            </td>

                        </tr>
                    }
                </tbody>
            </table>
            @if (ViewBag.Count == 0)
            {
                <div class="warning" style="width: 200px; margin: 0 auto;">
                    <p>No records found</p>
                </div>
            }
        </div>


    }
    <div id="dialog-edit" style="display:none">

    </div>*@